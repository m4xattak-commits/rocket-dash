<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rocket Dash</title>
<style>
  html,body { margin:0; height:100%; }
  body {
    background:#000;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:Arial,Helvetica,sans-serif;
    color:#fff;
  }
  #container {
    position:relative;
    width:800px;
    height:600px;
  }
  canvas {
    width:800px;
    height:600px;
    border:2px solid #fff;
    background:radial-gradient(circle at top,#071026,#000);
    display:block;
  }

  /* SCORE HUD */
  #scoreHud {
    position:absolute;
    top:10px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,0.4);
    padding:6px 14px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.2);
    font-size:18px;
    z-index:20;
    pointer-events:none;
  }

  /* MENU + LOCKER */
  .overlay {
    position:absolute;
    inset:0;
    background:rgba(0,0,0,0.85);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    gap:14px;
    z-index:50;
  }
  .hidden { display:none; }

  .title {
    font-size:42px;
    font-weight:900;
    text-shadow:0 0 12px #6cf;
  }

  .btn {
    padding:10px 26px;
    background:#2af;
    border:none;
    border-radius:999px;
    font-size:18px;
    font-weight:700;
    cursor:pointer;
    color:#000;
    box-shadow:0 0 10px #4cf;
  }

  #lockerBox {
    background:rgba(0,0,0,0.4);
    padding:20px;
    border-radius:10px;
    border:1px solid #555;
    width:400px;
    text-align:center;
  }

  .color-row {
    display:flex;
    justify-content:center;
    gap:10px;
    margin-top:10px;
  }

  .swatch {
    width:30px;
    height:30px;
    border-radius:6px;
    border:2px solid #333;
    cursor:pointer;
  }
  .swatch.selected {
    border-color:#fff;
    box-shadow:0 0 8px #fff;
  }
</style>
</head>
<body>

<div id="container">

  <canvas id="gameCanvas" width="800" height="600"></canvas>

  <div id="scoreHud">
    Score: <span id="score">0</span>
  </div>

  <!-- MAIN MENU -->
  <div id="menu" class="overlay">
    <div class="title">ROCKET DASH</div>
    <button id="startBtn" class="btn">START GAME</button>
    <button id="lockerBtn" class="btn">LOCKER</button>
  </div>

  <!-- LOCKER -->
  <div id="locker" class="overlay hidden">
    <div id="lockerBox">
      <h2>LOCKER</h2>

      <p>Rocket Color</p>
      <div class="color-row" id="rocketColors"></div>

      <p>Trail Color</p>
      <div class="color-row" id="trailColors"></div>

      <button id="backBtn" class="btn" style="margin-top:12px;">BACK</button>
    </div>
  </div>

  <!-- SOUND EFFECTS -->
  <audio id="explodeSfx" src="explode.wav"></audio>
  <audio id="deathSfx" src="death.wav"></audio>

</div>

<script>
/* ===== CANVAS ===== */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const W = canvas.width;
const H = canvas.height;

/* ===== UI ===== */
const menu = document.getElementById("menu");
const locker = document.getElementById("locker");
const startBtn = document.getElementById("startBtn");
const lockerBtn = document.getElementById("lockerBtn");
const backBtn = document.getElementById("backBtn");
const scoreEl = document.getElementById("score");
const explodeSfx = document.getElementById("explodeSfx");
const deathSfx = document.getElementById("deathSfx");

/* ===== GAME STATE ===== */
let running = false;
let score = 0;
let lastTime = 0;
let lastSpawn = 0;
let spawnInterval = 900;
let speedMultiplier = 1.0;
let difficultyTimer = 0;
let scoreTimer = 0; // +1 every 5 seconds

/* ===== PLAYER ===== */
const rocket = {
  x: W/2 - 20,
  y: H - 110,
  w: 40,
  h: 60,
  speed: 6,
  mainColor: "#ff4444",
  trailColor: "#4444ff",
  alive: true
};

/* ===== LOCKER COLORS ===== */
const rgb = ["#ff4444","#44ff44","#4444ff"];
const rocketColors = document.getElementById("rocketColors");
const trailColors = document.getElementById("trailColors");

function buildLocker() {
  rocketColors.innerHTML = "";
  trailColors.innerHTML = "";

  rgb.forEach((c,i)=>{
    const r = document.createElement("div");
    r.className = "swatch";
    r.style.background = c;
    r.addEventListener("click", ()=>{
      rocket.mainColor = c;
      [...rocketColors.children].forEach(x=>x.classList.remove("selected"));
      r.classList.add("selected");
    });
    rocketColors.appendChild(r);
    if (i===0) r.classList.add("selected");

    const t = document.createElement("div");
    t.className = "swatch";
    t.style.background = c;
    t.addEventListener("click", ()=>{
      rocket.trailColor = c;
      [...trailColors.children].forEach(x=>x.classList.remove("selected"));
      t.classList.add("selected");
    });
    trailColors.appendChild(t);
    if (i===2) t.classList.add("selected");
  });
}
buildLocker();

/* ===== INPUT ===== */
const keys = { left:false, right:false };
window.addEventListener("keydown", e=>{
  if (e.key==="ArrowLeft"||e.key==="a") keys.left = true;
  if (e.key==="ArrowRight"||e.key==="d") keys.right = true;
  if (e.code==="Space" && !running) startGame();
});
window.addEventListener("keyup", e=>{
  if (e.key==="ArrowLeft"||e.key==="a") keys.left = false;
  if (e.key==="ArrowRight"||e.key==="d") keys.right = false;
});

/* ===== METEORS ===== */
let meteors = [];
function spawnMeteor() {
  const size = 28 + Math.random()*56;
  meteors.push({
    x: Math.random()*(W-size),
    y: -size,
    w: size,
    h: size,
    speed: 120 + Math.random()*180
  });
}

/* ===== COLLISION ===== */
function collides(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
}

/* ===== EXPLOSION PARTICLES ===== */
let particles = [];
function explode(x,y,color){
  for (let i=0;i<30;i++){
    const ang = Math.random()*Math.PI*2;
    const spd = 80 + Math.random()*200;
    particles.push({
      x, y,
      vx: Math.cos(ang)*spd,
      vy: Math.sin(ang)*spd,
      life: 700 + Math.random()*500,
      age: 0,
      color
    });
  }
}
function updateParticles(dt){
  particles.forEach(p=>{
    p.age += dt;
    p.x += p.vx*(dt/1000);
    p.y += p.vy*(dt/1000);
    p.vy += 300*(dt/1000);
  });
  particles = particles.filter(p=>p.age<p.life);
}
function drawParticles(){
  particles.forEach(p=>{
    const t = 1 - p.age/p.life;
    ctx.fillStyle = `rgba(${hexToRgb(p.color)},${t})`;
    ctx.beginPath();
    ctx.arc(p.x,p.y,3+5*(1-t),0,Math.PI*2);
    ctx.fill();
  });
}
function hexToRgb(hex){
  const c = hex.replace("#","");
  return `${parseInt(c.slice(0,2),16)},${parseInt(c.slice(2,4),16)},${parseInt(c.slice(4,6),16)}`;
}

/* ===== DRAW ROCKET ===== */
function drawRocket(){
  // trail
  for (let i=0;i<6;i++){
    const a = (i+1)/6;
    ctx.fillStyle = `rgba(${hexToRgb(rocket.trailColor)},${0.12*(1-a)})`;
    ctx.beginPath();
    ctx.ellipse(rocket.x+rocket.w/2, rocket.y+rocket.h+i*6+6, rocket.w/4+i*2, 6+i*2, 0,0,Math.PI*2);
    ctx.fill();
  }

  // body
  ctx.fillStyle = rocket.mainColor;
  ctx.beginPath();
  ctx.moveTo(rocket.x+rocket.w/2, rocket.y);
  ctx.lineTo(rocket.x+rocket.w, rocket.y+rocket.h*0.6);
  ctx.lineTo(rocket.x+rocket.w*0.6, rocket.y+rocket.h*0.6);
  ctx.lineTo(rocket.x+rocket.w*0.6, rocket.y+rocket.h);
  ctx.lineTo(rocket.x+rocket.w*0.4, rocket.y+rocket.h);
  ctx.lineTo(rocket.x+rocket.w*0.4, rocket.y+rocket.h*0.6);
  ctx.lineTo(rocket.x, rocket.y+rocket.h*0.6);
  ctx.closePath();
  ctx.fill();

  // window
  ctx.fillStyle = "#9fdcff";
  ctx.beginPath();
  ctx.arc(rocket.x+rocket.w/2, rocket.y+rocket.h*0.35, 8, 0, Math.PI*2);
  ctx.fill();
}

/* ===== GAME LOOP ===== */
function loop(ts){
  if (!running) return;
  const dt = ts - lastTime;
  lastTime = ts;

  ctx.clearRect(0,0,W,H);

  // background stars
  ctx.fillStyle="#000";
  ctx.fillRect(0,0,W,H);
  for (let i=0;i<30;i++){
    ctx.fillStyle="rgba(255,255,255,0.03)";
    ctx.fillRect((i*47)%W,(i*73)%H,1,1);
  }

  // movement
  if (rocket.alive){
    if (keys.left) rocket.x -= rocket.speed*(1+(speedMultiplier-1)*0.5);
    if (keys.right) rocket.x += rocket.speed*(1+(speedMultiplier-1)*0.5);
    rocket.x = Math.max(0, Math.min(W-rocket.w, rocket.x));
  }

  // spawn meteors
  lastSpawn += dt;
  if (lastSpawn > spawnInterval){
    lastSpawn = 0;
    spawnMeteor();
  }

  // move meteors
  meteors.forEach(m=> m.y += m.speed*(dt/1000)*speedMultiplier );
  meteors = meteors.filter(m=>m.y<H+100);

  // collisions
  if (rocket.alive){
    for (let m of meteors){
      if (collides(rocket,m)){
        explode(rocket.x+rocket.w/2, rocket.y+rocket.h/2, rocket.mainColor);
        explodeSfx.currentTime=0; explodeSfx.play().catch(()=>{});
        setTimeout(()=>{ deathSfx.currentTime=0; deathSfx.play().catch(()=>{}); },80);
        rocket.alive=false;
        endGame();
        break;
      }
    }
  }

  // difficulty ramp
  difficultyTimer += dt;
  if (difficultyTimer >= 15000){
    difficultyTimer -= 15000;
    speedMultiplier += 0.06;
    spawnInterval = Math.max(300, spawnInterval - 40);
  }

  // score: +1 every 5 seconds
  scoreTimer += dt;
  if (scoreTimer >= 5000){
    score++;
    scoreTimer = 0;
  }
  scoreEl.textContent = score;

  // particles
  updateParticles(dt);

  // draw
  drawRocket();
  drawParticles();
  meteors.forEach(m=>{
    ctx.fillStyle="#9b59b6";
    ctx.fillRect(m.x,m.y,m.w,m.h);
  });

  requestAnimationFrame(loop);
}

/* ===== START / END ===== */
function startGame(){
  menu.classList.add("hidden");
  locker.classList.add("hidden");
  resetGame();
  running = true;
  lastTime = performance.now();
  requestAnimationFrame(loop);
}

function endGame(){
  running = false;
  ctx.fillStyle="rgba(0,0,0,0.6)";
  ctx.fillRect(0,0,W,H);
  ctx.fillStyle="#ff6b6b";
  ctx.font="36px Arial";
  ctx.textAlign="center";
  ctx.fillText("YOU DIED", W/2, H/2 - 10);
  ctx.font="18px Arial";
  ctx.fillStyle="#fff";
  ctx.fillText("Click or press Space to restart", W/2, H/2 + 24);
}

/* ===== RESET ===== */
function resetGame(){
  meteors = [];
  particles = [];
  score = 0;
  scoreTimer = 0;
  speedMultiplier = 1.0;
  spawnInterval = 900;
  difficultyTimer = 0;
  lastSpawn = 0;
  rocket.x = W/2 - rocket.w/2;
  rocket.y = H - 110;
  rocket.alive = true;
}

/* ===== UI BUTTONS ===== */
startBtn.addEventListener("click", startGame);
lockerBtn.addEventListener("click", ()=>{
  menu.classList.add("hidden");
  locker.classList.remove("hidden");
});
backBtn.addEventListener("click", ()=>{
  locker.classList.add("hidden");
  menu.classList.remove("hidden");
});

/* Restart on click */
canvas.addEventListener("click", ()=>{
  if (!running) startGame();
});

/* Focus canvas */
canvas.tabIndex = 0;
canvas.style.outline="none";
canvas.addEventListener("mousedown", e=>{ e.preventDefault(); canvas.focus(); });

/* INIT */
function init(){
  menu.classList.remove("hidden");
  locker.classList.add("hidden");
}
init();
</script>

</body>
</html>